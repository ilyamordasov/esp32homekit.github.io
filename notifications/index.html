<html>
<head>
    <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
<script type="text/javascript" async="" src="https://mod.calltouch.ru/front/init-widget.js?ctObject=ct&amp;rand=2956794"></script>
<script type="text/javascript" async="" src="https://mod.calltouch.ru/d_client_new.js?param;client_id1221311941.1586270346;ya_client_id1586270346414823607;;ref;urlhttps%3A%2F%2Ffactoringplus.ru%2F;cook&amp;mod_id=k9igrhgz&amp;script_session_id=171597e6e1a.8e3&amp;ctObject=ct&amp;uniq_req_id=1586344482789"></script>    
<script>
    window.onload = function() {
        window.notify = {
            list: [],
            id: 0,
            log: function(msg) {
                console.log("\n"+msg);
            },
            compatible: function() {
                if (typeof Notification === 'undefined') {
                    notify.log("Notifications are not available for your browser.");
                    return false;
                }
                return true;
            },
            authorize: function() {
                if (notify.compatible()) {
                    Notification.requestPermission(function(permission) {
                        notify.log("Permission to display: "+permission);
                    });
                }
            },
            showDelayed: function(seconds) {
                notify.log("A notification will be triggered in "+seconds+" seconds. Try minimising the browser now.");
                setTimeout(notify.show, (seconds*1000));
            },
            show: function() {

                if (typeof Notification === 'undefined') { notify.log("Notifications are not available for your browser."); return; }
                if (notify.compatible()) {
                    notify.id++;
                    var id = notify.id;
                    notify.list[id] = new Notification("Notification #"+id, {
                        body: "This is the text body of the notification. \nPretty cool, huh?",
                        tag: id,
                        icon: "http://cdn.sstatic.net/stackexchange/img/logos/so/so-icon.png",
                        lang: "",
                        dir: "auto",
                    });
                    notify.log("Notification #"+id+" queued for display");
                    notify.list[id].onclick = function() { notify.logEvent(id, "clicked"); };
                    notify.list[id].onshow  = function() { notify.logEvent(id, "showed");  };
                    notify.list[id].onerror = function() { notify.logEvent(id, "errored"); };
                    notify.list[id].onclose = function() { notify.logEvent(id, "closed");  };

                    console.log("Created a new notification ...");
                    console.log(notify.list[id]);
                }
            },
            logEvent: function(id, event) {
                notify.log("Notification #"+id+" "+event);
            }
        };
    };
    
    function ct() {
     

window.ctw.getRouteKeyData('my_form_1', function(success, data){
    console.log(success, data);
    if (success) {
        if (data.widgetFound) {
            if (data.widgetData.callCenterWorkingMode == 'working_hours') {
                console.log('колл-центр работает, отображение виджета');
            } else {
                if (data.widgetData.collectNonWorkingRequests) {
                    console.log('колл-центр не работает, но можем отобразить форму нерабочего времени');
                } else {
                    console.log('колл-центр не работает, заявки в нерабочее время не собираем');
                }
            }
        } else {
            console.log('не найден включенный виджет по routeKey, либо услуга обратного звонка не активна');
        }
    } else {
        console.log('во время обработки прозошла ошибка');
        console.log(data)
    }
 });   
    }
</script>
<script charset="utf-8" src="//mod.calltouch.ru/4.aec89c692b4460816942.js"></script>
</head>
<body>
    <button onclick="notify.authorize()">Authorize</button>
    <button onclick="notify.showDelayed(5)">Show in 5s</button>
    <!-- <script src="https://mod.calltouch.ru/init.js?id=k9igrhgz"></script> -->
</body>
</html>
